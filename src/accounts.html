<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All Accounts - Panduhz Financial Tracker</title>
  <link rel="stylesheet" href="accounts.css">
                                                                                                                                                <script>
  window.REACT_APP_API_URL = 'http://localhost:7071/api';
  window.REACT_APP_UPLOAD_API_URL = 'http://localhost:7072/api';
  window.REACT_APP_ENVIRONMENT = 'development';
  window.REACT_APP_DEBUG = true;
  window.REACT_APP_FIREBASE_API_KEY = 'AIzaSyB8sI0QryEvjMZaBoWfwuOfn5FHRqc-xeo';
  window.REACT_APP_FIREBASE_AUTH_DOMAIN = 'panduhz-tracker.firebaseapp.com';
  window.REACT_APP_FIREBASE_PROJECT_ID = 'panduhz-tracker';
</script>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1 class="title">All Accounts</h1>
      <div class="user-info">
        <span id="userName">Welcome, User!</span>
        <button class="btn btn-secondary" onclick="handleSignOut()">Sign Out</button>
      </div>
    </header>

    <!-- Financial Summary Cards -->
    <div class="summary-cards">
      <div class="card">
        <h3>Total Accounts</h3>
        <p id="totalAccounts">0</p>
      </div>
      <div class="card">
        <h3>Total Balance</h3>
        <p id="totalBalance">$0.00</p>
      </div>
      <div class="card">
        <h3>Monthly Income</h3>
        <p id="monthlyIncome">$0.00</p>
      </div>
      <div class="card">
        <h3>Monthly Expenses</h3>
        <p id="monthlyExpenses">$0.00</p>
      </div>
    </div>

    <!-- Navigation -->
    <div class="navigation">
      <button class="btn btn-secondary" onclick="goBack()">
        <span class="icon">‚Üê</span>
        Back to Dashboard
      </button>
      <button class="btn btn-primary" onclick="openRecurringModal()">
        <span class="icon">üîÑ</span>
        View All Recurring Transactions
      </button>
      <button class="btn btn-primary" onclick="openSearchModal()">
        <span class="icon">üîç</span>
        Search Transactions
      </button>
    </div>

    <!-- Accounts List -->
    <div class="accounts-section">
      <h2>Your Accounts</h2>
      <div id="accountsList" class="accounts-list">
        <div class="no-data">
          <p>No accounts found. Create your first account to get started!</p>
          <button class="btn btn-primary" onclick="goToCreateAccount()">Create Account</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Summary Modal -->
  <div id="accountSummaryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalAccountName">Account Summary</h2>
        <span class="close" onclick="closeAccountSummaryModal()">&times;</span>
      </div>
      <div class="modal-body">
        <div id="accountSummaryContent">
          <!-- Account summary content will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Account Confirmation Modal -->
  <div id="deleteAccountModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Delete Account</h2>
        <span class="close" onclick="closeDeleteAccountModal()">&times;</span>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete the account <strong id="deleteAccountName"></strong>?</p>
        <p class="warning-text">This action cannot be undone. The account will be marked as inactive and will no longer appear in your account list.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeDeleteAccountModal()">Cancel</button>
        <button class="btn btn-danger" onclick="deleteAccount()">Delete Account</button>
      </div>
    </div>
  </div>

  <!-- Search Transactions Modal -->
  <div id="searchModal" class="modal">
    <div class="modal-content search-modal">
      <div class="modal-header">
        <h2>Search Transactions</h2>
        <span class="close" onclick="closeSearchModal()">&times;</span>
      </div>
      <div class="modal-body">
        <form id="searchForm" onsubmit="performSearch(event)">
          <div class="search-form">
            <div class="form-group">
              <label for="searchDescription">Description</label>
              <input type="text" id="searchDescription" placeholder="Search by transaction description...">
            </div>
            
            <div class="form-group">
              <label for="searchCategory">Category</label>
              <select id="searchCategory">
                <option value="">All Categories</option>
                <option value="Food & Dining">Food & Dining</option>
                <option value="Transportation">Transportation</option>
                <option value="Shopping">Shopping</option>
                <option value="Entertainment">Entertainment</option>
                <option value="Bills & Utilities">Bills & Utilities</option>
                <option value="Healthcare">Healthcare</option>
                <option value="Education">Education</option>
                <option value="Travel">Travel</option>
                <option value="Income">Income</option>
                <option value="Other">Other</option>
              </select>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="searchStartDate">Start Date</label>
                <input type="date" id="searchStartDate">
              </div>
              <div class="form-group">
                <label for="searchEndDate">End Date</label>
                <input type="date" id="searchEndDate">
              </div>
            </div>
            
            <div class="form-group">
              <label for="searchTransactionType">Transaction Type</label>
              <select id="searchTransactionType">
                <option value="">All Types</option>
                <option value="income">Income</option>
                <option value="expense">Expense</option>
              </select>
            </div>
          </div>
        </form>
        
        <div id="searchResults" class="search-results" style="display: none;">
          <h3>Search Results</h3>
          <div id="searchResultsList" class="search-results-list">
            <!-- Search results will be populated here -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeSearchModal()">Close</button>
        <button class="btn btn-primary" onclick="performSearch()">Search</button>
        <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
      </div>
    </div>
  </div>

  <!-- Recurring Transactions Modal -->
  <div id="recurringModal" class="modal">
    <div class="modal-content recurring-modal">
      <div class="modal-header">
        <h2>All Recurring Transactions</h2>
        <span class="close" onclick="closeRecurringModal()">&times;</span>
      </div>
      <div class="modal-body">
        <div id="recurringContent">
          <div class="recurring-loading">
            <div class="loading-spinner"></div>
            <p>Loading recurring transactions...</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeRecurringModal()">Close</button>
        <button class="btn btn-primary" onclick="refreshRecurringTransactions()">Refresh</button>
      </div>
    </div>
  </div>

  <!-- Edit Transaction Modal -->
  <div id="editTransactionModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Edit Transaction</h2>
        <span class="close" onclick="closeEditTransactionModal()">&times;</span>
      </div>
      <form id="editTransactionForm" class="modal-body">
        <div class="form-group">
          <label for="editTransactionAmount">Amount *</label>
          <input type="number" id="editTransactionAmount" name="editTransactionAmount" step="0.01" required placeholder="0.00">
        </div>
        
        <div class="form-group">
          <label for="editTransactionDescription">Description *</label>
          <input type="text" id="editTransactionDescription" name="editTransactionDescription" required placeholder="e.g., Grocery shopping">
        </div>
        
        <div class="form-group">
          <label for="editTransactionCategory">Category *</label>
          <select id="editTransactionCategory" name="editTransactionCategory" required>
            <option value="">Select category</option>
            <option value="Food & Dining">Food & Dining</option>
            <option value="Transportation">Transportation</option>
            <option value="Shopping">Shopping</option>
            <option value="Entertainment">Entertainment</option>
            <option value="Bills & Utilities">Bills & Utilities</option>
            <option value="Healthcare">Healthcare</option>
            <option value="Education">Education</option>
            <option value="Travel">Travel</option>
            <option value="Income">Income</option>
            <option value="Other">Other</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="editTransactionType">Transaction Type *</label>
          <select id="editTransactionType" name="editTransactionType" required>
            <option value="">Select type</option>
            <option value="income">Income</option>
            <option value="expense">Expense</option>
            <option value="transfer">Transfer</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="editTransactionDate">Date *</label>
          <input type="date" id="editTransactionDate" name="editTransactionDate" required>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeEditTransactionModal()">Cancel</button>
          <button type="submit" class="btn btn-primary">Update Transaction</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Loading overlay -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-spinner"></div>
    <p>Loading...</p>
  </div>

  <!-- Firebase compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

  <!-- Include centralized configuration and utilities -->
  <script src="authService.js"></script>
  <script src="config.js"></script>
  <script src="utils.js"></script>
  <script src="cache.js"></script>
  <script src="auth.js"></script>
  <script src="accounts.js"></script>
</body>
</html>
